<?xml version="1.0" encoding="UTF-8"?>
<PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            PolicySetId="jisa13-final3" 
            PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:deny-overrides">
	<Description>The policy set for "view patient status".</Description>
	<Target>
		<Actions>
			<Action>
				<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
				  <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">view</AttributeValue>
					<ActionAttributeDesignator AttributeId="action:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</ActionMatch>
			</Action>
		</Actions>
		<Resources>
			<Resource>
				<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
				    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patientstatus</AttributeValue>
					<ResourceAttributeDesignator AttributeId="resource:type" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</ResourceMatch>
			</Resource>
		</Resources>
	</Target>
  <!-- begin consent -->
	<Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
          xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
          xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
          xmlns:md="urn:mdc:xacml" 
          PolicyId="policy:1" 
          RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
	  <Description>The consent policy.</Description>
	  <Target>
	    <Subjects>
		    <Subject>
			    <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
			      <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical_personnel</AttributeValue>
				    <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			    </SubjectMatch>
		    </Subject>
	    </Subjects>
    </Target>
	  <Rule RuleId="rule:1" Effect="Deny">
		  <Description>This is just the single rule for the above policy.</Description>
		  <Condition>
			  <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
			    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only">
              <SubjectAttributeDesignator AttributeId="subject:triggered_breaking_glass" DataType="http://www.w3.org/2001/XMLSchema#boolean"/>
            </Apply>
          </Apply>
		      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			        <SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
            </Apply>
		        <ResourceAttributeDesignator AttributeId="resource:owner-withdrawn-consents" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		      </Apply>
        </Apply>
		  </Condition>
	  </Rule>
  </Policy>
  <!-- end consent -->
  <!-- begin kinds of users -->
	<Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
          xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
          xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
          xmlns:md="urn:mdc:xacml" 
          PolicyId="policy:2" 
          RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	  <Description>Only physicians, nurses and patients can access the monitoring system.</Description>
	  <Target></Target>
	  <Rule RuleId="rule:2" Effect="Deny">
		  <Description>This is just the single rule for the above policy.</Description>
		  <Condition>
			  <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
			    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
			      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
              <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">nurse</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			      </Apply>
			      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
              <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			      </Apply>
			      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
              <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			      </Apply>
          </Apply>
        </Apply>
		  </Condition>
	  </Rule>
  </Policy>
  <!-- end kinds of users -->
  <!-- begin physicians -->
  <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              PolicySetId="policyset:2" 
              PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable">
	  <Description>For physicians</Description>
	  <Target>
		  <Subjects>
			  <Subject>
				  <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
				    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
					  <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				  </SubjectMatch>
			  </Subject>
		  </Subjects>
	  </Target>
    <!-- begin kinds of physicians -->
	  <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:3" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	    <Description>Of the physicians, only gps, physicians of the cardiology department, physicians of the elder care department and physicians of the emergency department can access the monitoring system.</Description>
	    <Target></Target>
	    <Rule RuleId="rule:3" Effect="Deny">
		    <Description>This is just the single rule for the above policy.</Description>
		    <Condition>
			    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
			      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
			        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">cardiology</AttributeValue>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		              <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
			        </Apply>
			        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">elder_care</AttributeValue>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		              <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
			        </Apply>
			        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">emergency</AttributeValue>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		              <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
			        </Apply>
			        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">gp</AttributeValue>
			          <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			        </Apply>
            </Apply>
          </Apply>
		    </Condition>
	    </Rule>
    </Policy>
    <!-- end kinds of physicians -->
    <!-- begin emergency -->
	  <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:4" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	    <Description>All of the previous physicians can access the monitoring system in case of emergency.</Description>
	    <Target>
	      <Subjects>
		      <Subject>
			      <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
			        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">cardiology</AttributeValue>
				      <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			      </SubjectMatch>
		      </Subject>
		      <Subject>
			      <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
			        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">elder_care</AttributeValue>
				      <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			      </SubjectMatch>
		      </Subject>
		      <Subject>
			      <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
			        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">emergency</AttributeValue>
				      <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			      </SubjectMatch>
		      </Subject>
	      </Subjects>
      </Target>
	    <Rule RuleId="rule:4" Effect="Permit">
		    <Description>This is just the single rule for the above policy.</Description>
		    <Condition>
	        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only">
              <SubjectAttributeDesignator AttributeId="subject:triggered_breaking_glass" DataType="http://www.w3.org/2001/XMLSchema#boolean"/>
            </Apply>
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only">
              <ResourceAttributeDesignator AttributeId="resource:operator_triggered_emergency" DataType="http://www.w3.org/2001/XMLSchema#boolean"/>
            </Apply>
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only">
              <ResourceAttributeDesignator AttributeId="resource:indicates_emergency" DataType="http://www.w3.org/2001/XMLSchema#boolean"/>
            </Apply>
          </Apply>
		    </Condition>
	    </Rule>
    </Policy>
    <!-- end emergency -->
    <!-- begin GPs -->
    <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                PolicySetId="policyset:3" 
                PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:permit-overrides">
      <Description>For GPs</Description>
      <Target>
        <Subjects>
	        <Subject>
		        <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">gp</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		        </SubjectMatch>
	        </Subject>
        </Subjects>
      </Target>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:5" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
        <Description>Permit if in consultation or treated in the last six months or primary physician or responsible in the system.</Description>
        <Target></Target>
        <Rule RuleId="rule:5" Effect="Permit">
          <Description>This is just the single rule for the above policy.</Description>
          <Condition>
		        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <SubjectAttributeDesignator AttributeId="subject:current-patient-in-consultation" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
		          </Apply>
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <SubjectAttributeDesignator AttributeId="subject:treated-in-last-six-months" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		          </Apply>
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <SubjectAttributeDesignator AttributeId="subject:primary-patients" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		          </Apply>
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <ResourceAttributeDesignator AttributeId="resource:owner:responsible-physicians" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		          </Apply>
            </Apply>
          </Condition>
        </Rule>
      </Policy>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:6" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
        <Description>Default deny.</Description>
        <Target></Target>
        <Rule RuleId="rule:6" Effect="Deny">
          <Description>This is just the single rule for the above policy.</Description>
        </Rule>
      </Policy>
    </PolicySet>
    <!-- end gps -->
    <!-- begin cardiologists -->
    <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                PolicySetId="policyset:4" 
                PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:permit-overrides">
      <Description>For cardiologists</Description>
      <Target>
        <Subjects>
	        <Subject>
		        <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">cardiology</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		        </SubjectMatch>
	        </Subject>
        </Subjects>
      </Target>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:7" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
        <Description>Permit for head physician</Description>
        <Target>
          <Subjects>
	          <Subject>
              <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:boolean-equal">
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#boolean">true</AttributeValue>
	              <SubjectAttributeDesignator AttributeId="subject:is-head-physician" DataType="http://www.w3.org/2001/XMLSchema#boolean"/>
              </SubjectMatch>
	          </Subject>
          </Subjects>
        </Target>
        <Rule RuleId="rule:7" Effect="Permit">
          <Description>This is just the single rule for the above policy.</Description>
        </Rule>
      </Policy>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:8" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
        <Description>Permit if treated the patient or treated in team.</Description>
        <Target></Target>
        <Rule RuleId="rule:8" Effect="Permit">
          <Description>This is just the single rule for the above policy.</Description>
          <Condition>
		        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <SubjectAttributeDesignator AttributeId="subject:treated" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		          </Apply>
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <SubjectAttributeDesignator AttributeId="subject:treated-by-team" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		          </Apply>
            </Apply>
          </Condition>
        </Rule>
      </Policy>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:9" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
        <Description>Default deny</Description>
        <Target></Target>
        <Rule RuleId="rule:9" Effect="Deny">
          <Description>This is just the single rule for the above policy.</Description>
        </Rule>
      </Policy>
    </PolicySet>
    <!-- end cardiologists -->
    <!-- begin elder care -->
    <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                PolicySetId="policyset:5" 
                PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:permit-overrides"
                confidential="true">
      <Description>For physicians of elder care department</Description>
      <Target>
        <Subjects>
	        <Subject>
		        <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">elder_care</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		        </SubjectMatch>
	        </Subject>
        </Subjects>
      </Target>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:10" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
        <Description>Permit if admitted in care unit or treated in the last six months.</Description>
        <Target></Target>
        <Rule RuleId="rule:10" Effect="Permit">
          <Description>This is just the single rule for the above policy.</Description>
          <Condition>
		        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <SubjectAttributeDesignator AttributeId="subject:admitted-patients-in-care-unit" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		          </Apply>
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
	                <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <SubjectAttributeDesignator AttributeId="subject:treated-in-last-six-months" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		          </Apply>
            </Apply>
          </Condition>
        </Rule>
      </Policy>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:11" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
        <Description>Default deny</Description>
        <Target></Target>
        <Rule RuleId="rule:11" Effect="Deny">
          <Description>This is just the single rule for the above policy.</Description>
        </Rule>
      </Policy>
    </PolicySet>
    <!-- end elder care -->
    <!-- begin emergency department -->
    <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                PolicySetId="policyset:6" 
                PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:permit-overrides">
      <Description>For physicians of emergency department</Description>
      <Target>
        <Subjects>
	        <Subject>
		        <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">emergency</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		        </SubjectMatch>
	        </Subject>
        </Subjects>
      </Target>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:12" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
        <Description>Permit if patient status is bad (or the above).</Description>
        <Target></Target>
        <Rule RuleId="rule:12" Effect="Permit">
          <Description>This is just the single rule for the above policy.</Description>
          <Condition>
	          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">bad</AttributeValue>
              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			          <ResourceAttributeDesignator AttributeId="resource:patient-status" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              </Apply>
	          </Apply>
          </Condition>
        </Rule>
      </Policy>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:13" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides"
              confidential="true">
        <Description>Default deny</Description>
        <Target></Target>
        <Rule RuleId="rule:13" Effect="Deny">
          <Description>This is just the single rule for the above policy.</Description>
        </Rule>
      </Policy>
    </PolicySet>
    <!-- end emergency department -->
  </PolicySet>
  <!-- end physicians -->
  <!-- begin nurses -->
  <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              PolicySetId="policyset:7" 
              PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable">
	  <Description>For nurses</Description>
	  <Target>
        <Subjects>
	        <Subject>
		        <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">nurse</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		        </SubjectMatch>
	        </Subject>
        </Subjects>
	  </Target>
    <!-- begin kinds of nurses -->
	  <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:14" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	    <Description>Of the nurses, only nurses of the cardiology department or the elder care department can access the PMS.</Description>
	    <Target></Target>
	    <Rule RuleId="rule:14" Effect="Deny">
		    <Description>This is just the single rule for the above policy.</Description>
		    <Condition>
			    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
			      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
			        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">cardiology</AttributeValue>
			          <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
			        </Apply>
			        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">elder_care</AttributeValue>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		              <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
			        </Apply>
            </Apply>
          </Apply>
		    </Condition>
	    </Rule>
    </Policy>
    <!-- end kinds of nurses -->
    <!-- begin shifts -->
	  <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:15" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	    <Description>Nurses can only access the PMS during their shifts.</Description>
	    <Target></Target>
	    <Rule RuleId="rule:15" Effect="Deny">
		    <Description>This is just the single rule for the above policy.</Description>
		    <Condition>
			    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
			      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
			        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-greater-than-or-equal">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only">
                  <EnvironmentAttributeDesignator AttributeId="environment:currentDateTime" DataType="http://www.w3.org/2001/XMLSchema#dateTime"/>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only">
  			          <SubjectAttributeDesignator AttributeId="subject:shift_start" DataType="http://www.w3.org/2001/XMLSchema#dateTime"/>
                </Apply>
			        </Apply>
			        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-less-than-or-equal">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only">
                  <EnvironmentAttributeDesignator AttributeId="environment:currentDateTime" DataType="http://www.w3.org/2001/XMLSchema#dateTime"/>
                </Apply>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only">
  			          <SubjectAttributeDesignator AttributeId="subject:shift_stop" DataType="http://www.w3.org/2001/XMLSchema#dateTime"/>
                </Apply>
              </Apply>
            </Apply>
          </Apply>
		    </Condition>
	    </Rule>
    </Policy>
    <!-- end shifts -->
    <!-- begin location -->
	  <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:16" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	    <Description>Nurses can only access the PMS from the hospital.</Description>
	    <Target></Target>
	    <Rule RuleId="rule:16" Effect="Deny">
		    <Description>This is just the single rule for the above policy.</Description>
		    <Condition>
			    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
	            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">hospital</AttributeValue>
              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		            <SubjectAttributeDesignator AttributeId="subject:location" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              </Apply>
            </Apply>
          </Apply>
		    </Condition>
	    </Rule>
    </Policy>
    <!-- end location -->
    <!-- begin last 5 days -->
	  <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:17" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	    <Description>Nurses can only view the patient's status of the last five days.</Description>
	    <Target></Target>
	    <Rule RuleId="rule:17" Effect="Deny">
		    <Description>This is just the single rule for the above policy.</Description>
		    <Condition>
			    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
		        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-less-than-or-equal">
              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only">
                <EnvironmentAttributeDesignator AttributeId="environment:currentDateTime" DataType="http://www.w3.org/2001/XMLSchema#dateTime"/>
              </Apply>
              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-add-dayTimeDuration">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only">
                  <ResourceAttributeDesignator AttributeId="resource:created" DataType="http://www.w3.org/2001/XMLSchema#dateTime"/>
                </Apply>
                <AttributeValue DataType="http://www.w3.org/TR/2002/WD-xquery-operators-20020816#dayTimeDuration">P5D</AttributeValue>
              </Apply>
            </Apply>
          </Apply>
		    </Condition>
	    </Rule>
    </Policy>
    <!-- end last 5 days -->
    <!-- begin cardiology nurses -->
    <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                PolicySetId="policyset:8" 
                PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:permit-overrides">
      <Description>For nurses of emergency department</Description>
      <Target>
        <Subjects>
	        <Subject>
		        <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">cardiology</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		        </SubjectMatch>
	        </Subject>
        </Subjects>
      </Target>
	    <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:18" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	      <Description>Nurses of the cardiology department can only view the patient status of a patient in their nurse unit for whome they are assigned responsible, up to three days after they were discharged.</Description>
	      <Target>
          <Subjects>
	          <Subject>
		          <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">cardiology</AttributeValue>
			          <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		          </SubjectMatch>
	          </Subject>
          </Subjects>
        </Target>
	      <Rule RuleId="rule:18" Effect="Permit">
		      <Description>This is just the single rule for the above policy.</Description>
		      <Condition>
	          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
	            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                  <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                </Apply>
                <SubjectAttributeDesignator AttributeId="subject:admitted-patients-in-nurse-unit" DataType="http://www.w3.org/2001/XMLSchema#string"/>
	            </Apply>
		          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
	              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                  <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only">
                    <ResourceAttributeDesignator AttributeId="resource:owner:discharged" DataType="http://www.w3.org/2001/XMLSchema#boolean"/>
                  </Apply>
	              </Apply>
		            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-less-than-or-equal">
                  <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only">
    			          <EnvironmentAttributeDesignator AttributeId="environment:currentDateTime" DataType="http://www.w3.org/2001/XMLSchema#dateTime"/>
                  </Apply>
                  <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-add-dayTimeDuration">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:dateTime-one-and-only">
                      <ResourceAttributeDesignator AttributeId="resource:owner:discharged-dateTime" DataType="http://www.w3.org/2001/XMLSchema#dateTime"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/TR/2002/WD-xquery-operators-20020816#dayTimeDuration">P3D</AttributeValue>
                  </Apply>
                </Apply>
              </Apply>
            </Apply>
		      </Condition>
	      </Rule>
      </Policy>
      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:19" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
        <Description>Default deny.</Description>
        <Target></Target>
        <Rule RuleId="rule:19" Effect="Deny">
          <Description>This is just the single rule for the above policy.</Description>
        </Rule>
      </Policy>
    </PolicySet>
    <!-- end cardiology nurses -->
    <!-- begin elder care nurses -->
    <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                PolicySetId="policyset:9" 
                PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:deny-overrides">
      <Description>For nurses of emergency department</Description>
      <Target>
        <Subjects>
	        <Subject>
		        <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">elder_care</AttributeValue>
			        <SubjectAttributeDesignator AttributeId="subject:department" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		        </SubjectMatch>
	        </Subject>
        </Subjects>
      </Target>	    
	    <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
              xmlns:md="urn:mdc:xacml" 
              PolicyId="policy:20" 
              RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	      <Description>Of the nurses of the elder care department, only nurses who have been allowed to use the PMS can access the PMS.</Description>
	      <Target></Target>
	      <Rule RuleId="rule:20" Effect="Deny">
		      <Description>This is just the single rule for the above policy.</Description>
		      <Condition>
			      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only">
			          <SubjectAttributeDesignator AttributeId="subject:allowed-to-access-pms" DataType="http://www.w3.org/2001/XMLSchema#boolean"/>
              </Apply>
            </Apply>
		      </Condition>
	      </Rule>
      </Policy>
      <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                  xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                  PolicySetId="policyset:10" 
                  PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:permit-overrides">
        <Description>Nurses of the elder care department can only view the patient status of a patient who is currently admitted to their nurse unit and for whome they are assigned responsible.</Description>
        <Target></Target>
	      <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
                xmlns:md="urn:mdc:xacml" 
                PolicyId="policy:21" 
                RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	        <Description>Nurses of the elder care department can only view the patient status of a patient who is currently admitted to their nurse unit and for whome they are assigned responsible.</Description>
	        <Target></Target>
	        <Rule RuleId="rule:21" Effect="Permit">
		        <Description>This is just the single rule for the above policy.</Description>
		        <Condition>
	            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
	              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                  <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                    <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                  </Apply>
                  <SubjectAttributeDesignator AttributeId="subject:admitted-patients-in-nurse-unit" DataType="http://www.w3.org/2001/XMLSchema#string"/>
	              </Apply>
	              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
                  <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                    <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
                  </Apply>
                  <SubjectAttributeDesignator AttributeId="subject:responsible-patients" DataType="http://www.w3.org/2001/XMLSchema#string"/>
	              </Apply>
              </Apply>
		        </Condition>
	        </Rule>
        </Policy>
        <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
                xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
                xmlns:md="urn:mdc:xacml" 
                PolicyId="policy:22" 
                RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
          <Description>Default deny.</Description>
          <Target></Target>
          <Rule RuleId="rule:22" Effect="Deny">
            <Description>This is just the single rule for the above policy.</Description>
          </Rule>
        </Policy>
      </PolicySet>
    </PolicySet>
    <!-- end elder care nurses -->
  </PolicySet>
  <!-- end nurses -->
  <!-- begin patients -->
  <PolicySet  xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
              xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
              PolicySetId="policyset:11" 
              PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable">
	  <Description>For patients</Description>
	  <Target>
      <Subjects>
        <Subject>
	        <SubjectMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
	          <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient</AttributeValue>
		        <SubjectAttributeDesignator AttributeId="subject:roles" DataType="http://www.w3.org/2001/XMLSchema#string"/>
	        </SubjectMatch>
        </Subject>
      </Subjects>
	  </Target>
    <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:23" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
      <Description>A patient can only access the PMS if (still) allowed by the hospital (e.g., has subscribed to the PMS, but is not paying any more).</Description>
      <Target></Target>
      <Rule RuleId="rule:23" Effect="Deny">
        <Description>This is just the single rule for the above policy.</Description>
        <Condition>
  			  <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-one-and-only">
              <SubjectAttributeDesignator AttributeId="subject:allowed-to-access-pms" DataType="http://www.w3.org/2001/XMLSchema#boolean"/>
            </Apply>
          </Apply>
        </Condition>
      </Rule>
    </Policy>
    <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:24" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
      <Description>A patient can only view his own status.</Description>
      <Target></Target>
      <Rule RuleId="rule:24" Effect="Deny">
        <Description>This is just the single rule for the above policy.</Description>
        <Condition>
	        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
	          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                <ResourceAttributeDesignator AttributeId="resource:owner:id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              </Apply>
              <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                <SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
              </Apply>
	          </Apply>
          </Apply>
        </Condition>
      </Rule>
    </Policy>
    <Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" 
            xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:os" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
            xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
            xmlns:md="urn:mdc:xacml" 
            PolicyId="policy:25" 
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
      <Description>Default allow.</Description>
      <Target></Target>
      <Rule RuleId="rule:25" Effect="Permit">
        <Description>This is just the single rule for the above policy.</Description>
      </Rule>
    </Policy>
  </PolicySet>
</PolicySet>
<!-- the end -->
